namespace de:: vimotest:: examples:: loginview ;

private import Testing ;

class LoginViewModelTests {
  
  private sut : LoginViewModel  ;
  
  private testEnvironment : LoginViewModelTestEnvironment  ;
  
  
  protected BeforeTest (  ) {
    this.testEnvironment = new LoginViewModelTestEnvironmentImpl (  );

    this.testEnvironment.Init (  );

  }
  
  /** 
  Scenario: Load View on empty context
    given: empty context
     when: LoadViewModel and fill 'User' in  Username and fill 'MyPass123' in  Password and check ShowPassword
     then: Username shows text 'User' and Password shows text 'MyPass123' and Login is enabled */

  public Load_View_on_empty_context_given_empty_context_when_LoadViewModel_and_fill_User_in_Username_and_fill_MyPass123_in_Password_and_check_ShowPassword_then_Username_shows_text_User_and_Password_shows_text_MyPass123_and_Login_is_enabled (  ) {
    this.given_empty_context (  );

    this.BuildSut (  );

    this.when_LoadViewModel (  );

    this.when_fill_User_in_Username (  );

    this.when_fill_MyPass123_in_Password (  );

    this.when_check_ShowPassword (  );

    this.then_Username_shows_text_User_ (  );

    this.then_Password_shows_text_MyPass123_ (  );

    this.then_Login_is_enabled (  );

  }
  /** 
  Scenario: Load View on empty context
    given: empty context
     when: LoadViewModel and fill 'User' in  Username and clear text in Password
     then: Username shows text 'User' and Password shows empty text and Login is not enabled */

  public Load_View_on_empty_context_given_empty_context_when_LoadViewModel_and_fill_User_in_Username_and_clear_text_in_Password_then_Username_shows_text_User_and_Password_shows_empty_text_and_Login_is_not_enabled (  ) {
    this.given_empty_context (  );

    this.BuildSut (  );

    this.when_LoadViewModel (  );

    this.when_fill_User_in_Username (  );

    this.when_clear_text_in_Password (  );

    this.then_Username_shows_text_User_ (  );

    this.then_Password_shows_empty_text (  );

    this.then_Login_is_not_enabled (  );

  }
  /** 
  Scenario: Load View on Pre-filled User-Preferences
    given: prefilledValues
     when: LoadViewModel
     then: Username shows text 'Ada' and Password shows text '******' and Login is enabled */

  public Load_View_on_Pre_filled_User_Preferences_given_prefilledValues_when_LoadViewModel_then_Username_shows_text_Ada_and_Password_shows_text_____and_Login_is_enabled (  ) {
    this.given_prefilledValues (  );

    this.BuildSut (  );

    this.when_LoadViewModel (  );

    this.then_Username_shows_text_Ada_ (  );

    this.then_Password_shows_text_____ (  );

    this.then_Login_is_enabled (  );

  }
  /** 
  Scenario: Load View on Pre-filled User-Preferences
    given: prefilledValues
     when: LoadViewModel and check ShowPassword
     then: Username shows text 'Ada' and Password shows text 'Lovelace1' and ShowPassword is checked and Login is enabled */

  public Load_View_on_Pre_filled_User_Preferences_given_prefilledValues_when_LoadViewModel_and_check_ShowPassword_then_Username_shows_text_Ada_and_Password_shows_text_Lovelace1_and_ShowPassword_is_checked_and_Login_is_enabled (  ) {
    this.given_prefilledValues (  );

    this.BuildSut (  );

    this.when_LoadViewModel (  );

    this.when_check_ShowPassword (  );

    this.then_Username_shows_text_Ada_ (  );

    this.then_Password_shows_text_Lovelace1_ (  );

    this.then_ShowPassword_is_checked (  );

    this.then_Login_is_enabled (  );

  }
  /** 
  Scenario: Load View on Pre-filled User-Preferences
    given: prefilledValues
     when: LoadViewModel and fill 'lovelace' in  Password and click Login
     then: Error shows text 'Needs uppercase letters' */

  public Load_View_on_Pre_filled_User_Preferences_given_prefilledValues_when_LoadViewModel_and_fill_lovelace_in_Password_and_click_Login_then_Error_shows_text_Needs_uppercase_letters_ (  ) {
    this.given_prefilledValues (  );

    this.BuildSut (  );

    this.when_LoadViewModel (  );

    this.when_fill_lovelace_in_Password (  );

    this.when_click_Login (  );

    this.then_Error_shows_text_Needs_uppercase_letters_ (  );

  }
  
  
  protected BuildSut (  ) {
    this.sut = this.testEnvironment.BuildSut (  );

  }
  
  
  // Given Helper Definitions

  
  public given_empty_context (  ) {    
  }
  
  private prefilledValues : String = "<Prefs>  \n  <User>Ada</User>\n  <Pw>Lovelace1</Pw>\n</Prefs>";
  
  public given_prefilledValues (  ) {
    this.testEnvironment.SetXmlElementContext ( this.prefilledValues );

  }
  
  // When Helper Definitions

  
  public when_LoadViewModel (  ) {
    this.sut.loadViewModel (  );

  }
  
  public when_fill_User_in_Username (  ) {
    this.sut.usernameTextBoxTextFilled ( "User" );

  }
  
  public when_fill_MyPass123_in_Password (  ) {
    this.sut.passwordTextBoxTextFilled ( "MyPass123" );

  }
  
  public when_check_ShowPassword (  ) {
    this.sut.showPasswordCheckBoxChecked ( true );

  }
  
  public when_clear_text_in_Password (  ) {
    this.sut.passwordTextBoxTextFilled ( "" );

  }
  
  public when_fill_lovelace_in_Password (  ) {
    this.sut.passwordTextBoxTextFilled ( "lovelace" );

  }
  
  public when_click_Login (  ) {
    this.sut.loginButtonClicked (  );

  }
  
  // Then Helper Definitions

  
  public then_Username_shows_text_User_ (  ) {
    AssertEqualWithMessage ( "User", this.sut.getUsernameTextBoxText (  ), "Expected that textbox Username has text <" + "User" + ">, but was <" + this.sut.getUsernameTextBoxText (  ) + ">" );

  }
  
  public then_Password_shows_text_MyPass123_ (  ) {
    AssertEqualWithMessage ( "MyPass123", this.sut.getPasswordTextBoxText (  ), "Expected that textbox Password has text <" + "MyPass123" + ">, but was <" + this.sut.getPasswordTextBoxText (  ) + ">" );

  }
  
  public then_Login_is_enabled (  ) {
    AssertTrueWithMessage ( this.sut.getIsLoginButtonEnabled (  ), "Expected button Login is enabled, but it was disabled" );

  }
  
  public then_Password_shows_empty_text (  ) {
    AssertEqualWithMessage ( "", this.sut.getPasswordTextBoxText (  ), "Expected that textbox Password has text <" + "" + ">, but was <" + this.sut.getPasswordTextBoxText (  ) + ">" );

  }
  
  public then_Login_is_not_enabled (  ) {
    AssertFalseWithMessage ( this.sut.getIsLoginButtonEnabled (  ), "Expected button Login is disabled, but it was enabled" );

  }
  
  public then_Username_shows_text_Ada_ (  ) {
    AssertEqualWithMessage ( "Ada", this.sut.getUsernameTextBoxText (  ), "Expected that textbox Username has text <" + "Ada" + ">, but was <" + this.sut.getUsernameTextBoxText (  ) + ">" );

  }
  
  public then_Password_shows_text_____ (  ) {
    AssertEqualWithMessage ( "******", this.sut.getPasswordTextBoxText (  ), "Expected that textbox Password has text <" + "******" + ">, but was <" + this.sut.getPasswordTextBoxText (  ) + ">" );

  }
  
  public then_Password_shows_text_Lovelace1_ (  ) {
    AssertEqualWithMessage ( "Lovelace1", this.sut.getPasswordTextBoxText (  ), "Expected that textbox Password has text <" + "Lovelace1" + ">, but was <" + this.sut.getPasswordTextBoxText (  ) + ">" );

  }
  
  public then_ShowPassword_is_checked (  ) {
    AssertTrueWithMessage ( this.sut.getIsShowPasswordCheckBoxChecked (  ), "Expected that checkbox ShowPassword is checked, but was <" + ( this.sut.getIsShowPasswordCheckBoxChecked (  ) ? "checked" : "unchecked" ) + ">" );

  }
  
  public then_Error_shows_text_Needs_uppercase_letters_ (  ) {
    AssertEqualWithMessage ( "Needs uppercase letters", this.sut.getErrorLabelText (  ), "Expected that label Error has text <" + "Needs uppercase letters" + ">, but was <" + this.sut.getErrorLabelText (  ) + ">" );

  }
}
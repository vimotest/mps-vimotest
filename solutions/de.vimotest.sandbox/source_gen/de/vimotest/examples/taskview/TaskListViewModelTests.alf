

private import Testing ;

class TaskListViewModelTests {
  
  private sut : TaskListViewModel  ;
  
  private contextProvider : TaskListViewModelContextProvider  ;
  
  
  protected BeforeTest (  ) {
  this.contextProvider = new TaskListViewModelContextProvider (  );
   this.contextProvider.Init (  );
 }
  
  
  public Load_Tasks_and_Add_New_given_sampleTasks_when_LoadView_and_click_AddNewTask_then_Tasks_has_3_rows_and_selected_row_handle_2_and_AddNewTask_is_enabled_and_DeleteTask_is_enabled (  ) {
  this.given_sampleTasks (  );
   this.BuildSut (  );
   this.when_LoadView (  );
   this.when_click_AddNewTask (  );
   this.then_Tasks_has_3_rows_and_selected_row_handle_2 (  );
   this.then_AddNewTask_is_enabled (  );
   this.then_DeleteTask_is_enabled (  );
 }
  
  public Load_Empty_Tasks_given_when_LoadView_then_Tasks_has_0_rows (  ) {
  this.BuildSut (  );
   this.when_LoadView1 (  );
   this.then_Tasks_has_0_rows (  );
 }
  
  public Load_one_Task_with_all_values_given_oneTask_when_LoadView_then_Tasks_has_1_rows (  ) {
  this.given_oneTask (  );
   this.BuildSut (  );
   this.when_LoadView2 (  );
   this.then_Tasks_has_1_rows (  );
 }
  
  public Initial_selection_given_twoTasks_when_LoadView_then_Tasks_has_2_rows_and_selected_row_handle_0 (  ) {
  this.given_twoTasks (  );
   this.BuildSut (  );
   this.when_LoadView3 (  );
   this.then_Tasks_has_2_rows_and_selected_row_handle_0 (  );
 }
  
  public Add_New_Task_given_oneTaskA_when_LoadView_and_click_AddNewTask_then_Tasks_has_2_rows_and_selected_row_handle_1 (  ) {
  this.given_oneTaskA (  );
   this.BuildSut (  );
   this.when_LoadView4 (  );
   this.when_click_AddNewTask1 (  );
   this.then_Tasks_has_2_rows_and_selected_row_handle_1 (  );
 }
  
  public Delete_Task_given_threeTasks_when_LoadView_and_select_row_0_in_Tasks_and_click_DeleteTask_then_Tasks_has_2_rows_and_selected_row_handle_1 (  ) {
  this.given_threeTasks (  );
   this.BuildSut (  );
   this.when_LoadView5 (  );
   this.when_select_row_0_in_Tasks (  );
   this.when_click_DeleteTask (  );
   this.then_Tasks_has_2_rows_and_selected_row_handle_11 (  );
 }
  
  public Delete_Task_given_threeTasks_when_LoadView_and_select_row_1_in_Tasks_and_click_DeleteTask_then_Tasks_has_2_rows_and_selected_row_handle_2 (  ) {
  this.given_threeTasks (  );
   this.BuildSut (  );
   this.when_LoadView6 (  );
   this.when_select_row_1_in_Tasks (  );
   this.when_click_DeleteTask1 (  );
   this.then_Tasks_has_2_rows_and_selected_row_handle_2 (  );
 }
  
  public Delete_Task_given_threeTasks_when_LoadView_and_select_row_2_in_Tasks_and_click_DeleteTask_then_Tasks_has_2_rows_and_selected_row_handle_1 (  ) {
  this.given_threeTasks (  );
   this.BuildSut (  );
   this.when_LoadView7 (  );
   this.when_select_row_2_in_Tasks (  );
   this.when_click_DeleteTask2 (  );
   this.then_Tasks_has_2_rows_and_selected_row_handle_12 (  );
 }
  
  public Delete_Task_given_threeTasks_when_LoadView_and_click_DeleteTask_and_click_DeleteTask_and_click_DeleteTask_then_Tasks_has_0_rows (  ) {
  this.given_threeTasks (  );
   this.BuildSut (  );
   this.when_LoadView8 (  );
   this.when_click_DeleteTask3 (  );
   this.when_click_DeleteTask4 (  );
   this.when_click_DeleteTask5 (  );
   this.then_Tasks_has_0_rows1 (  );
 }
  
  public Load_Tasks_with_all_three_priority_levels_given_priorityCombinations_when_LoadView_then_Tasks_has_3_rows (  ) {
  this.given_priorityCombinations (  );
   this.BuildSut (  );
   this.when_LoadView9 (  );
   this.then_Tasks_has_3_rows (  );
 }
  
  public Due_Date_from_2023_given_dueDate2023_when_LoadView_then_Tasks_has_1_rows (  ) {
  this.given_dueDate2023 (  );
   this.BuildSut (  );
   this.when_LoadView10 (  );
   this.then_Tasks_has_1_rows1 (  );
 }
  
  public Due_Date_Tooltip_given_dueDate2024_when_LoadView_then_Tasks_has_1_rows (  ) {
  this.given_dueDate2024 (  );
   this.BuildSut (  );
   this.when_LoadView11 (  );
   this.then_Tasks_has_1_rows2 (  );
 }
  
  public Delete_disabled_if_nothing_selected_given_emptyTasks_when_LoadView_and_select_row_0_in_Tasks_and_click_DeleteTask_then_AddNewTask_is_enabled_and_DeleteTask_is_not_enabled (  ) {
  this.given_emptyTasks (  );
   this.BuildSut (  );
   this.when_LoadView12 (  );
   this.when_select_row_0_in_Tasks1 (  );
   this.when_click_DeleteTask6 (  );
   this.then_AddNewTask_is_enabled1 (  );
   this.then_DeleteTask_is_not_enabled (  );
 }
  
  
  protected BuildSut (  ) {
  this.sut = this.contextProvider.BuildSut (  );
 }
  
  
  // Given Helper Definitions

  
  private sampleTasks : String = "[ { id:\"0\", name:\"Exercise\", priority:\"low\", dueDate:\"2024/01/04\" },\n  { id:\"1\", name:\"Taxes\", priority:\"high\", dueDate:\"2023/12/31\" } ]";
  
  public given_sampleTasks (  ) {
  this.contextProvider.SetDataTableJson ( this.sampleTasks );
 }
  
  private oneTask : String = "[ { id:\"0\", name:\"A\", priority:\"low\", dueDate:\"2024/12/01\" } ]";
  
  public given_oneTask (  ) {
  this.contextProvider.SetDataTableJson ( this.oneTask );
 }
  
  private twoTasks : String = "[ { id:\"0\", name:\"A\" },\n  { id:\"1\", name:\"B\" } ]";
  
  public given_twoTasks (  ) {
  this.contextProvider.SetDataTableJson ( this.twoTasks );
 }
  
  private oneTaskA : String = "[ { id:\"0\", name:\"A\" } ]";
  
  public given_oneTaskA (  ) {
  this.contextProvider.SetDataTableJson ( this.oneTaskA );
 }
  
  private threeTasks : String = "[ { id:\"0\", name:\"A\" },\n  { id:\"1\", name:\"B\" },\n  { id:\"2\", name:\"C\" } ]";
  
  public given_threeTasks (  ) {
  this.contextProvider.SetDataTableJson ( this.threeTasks );
 }
  
  private priorityCombinations : String = "[ { id:\"0\", priority:\"low\" },\n  { id:\"1\", priority:\"medium\" },\n  { id:\"2\", priority:\"high\" } ]";
  
  public given_priorityCombinations (  ) {
  this.contextProvider.SetDataTableJson ( this.priorityCombinations );
 }
  
  private dueDate2023 : String = "[ { id:\"0\", name:\"Task A\", dueDate:\"2023/01/01\" } ]";
  
  public given_dueDate2023 (  ) {
  this.contextProvider.SetDataTableJson ( this.dueDate2023 );
 }
  
  private dueDate2024 : String = "[ { id:\"0\", name:\"Task A\", dueDate:\"2024/10/11\" } ]";
  
  public given_dueDate2024 (  ) {
  this.contextProvider.SetDataTableJson ( this.dueDate2024 );
 }
  
  private emptyTasks : String = "[ { id:\"0\", name:\"Task A\", dueDate:\"2023/01/01\" } ]";
  
  public given_emptyTasks (  ) {
  this.contextProvider.SetDataTableJson ( this.emptyTasks );
 }
  
  // When Helper Definitions

  
  public when_LoadView (  ) {
  this.sut.loadView (  );
 }
  
  public when_click_AddNewTask (  ) {
  this.sut.addNewTaskClicked (  );
 }
  
  public when_LoadView1 (  ) {
  this.sut.loadView (  );
 }
  
  public when_LoadView2 (  ) {
  this.sut.loadView (  );
 }
  
  public when_LoadView3 (  ) {
  this.sut.loadView (  );
 }
  
  public when_LoadView4 (  ) {
  this.sut.loadView (  );
 }
  
  public when_click_AddNewTask1 (  ) {
  this.sut.addNewTaskClicked (  );
 }
  
  public when_LoadView5 (  ) {
  this.sut.loadView (  );
 }
  
  public when_select_row_0_in_Tasks (  ) {
  this.sut.tasksRowSelected ( "0" );
 }
  
  public when_click_DeleteTask (  ) {
  this.sut.deleteTaskClicked (  );
 }
  
  public when_LoadView6 (  ) {
  this.sut.loadView (  );
 }
  
  public when_select_row_1_in_Tasks (  ) {
  this.sut.tasksRowSelected ( "1" );
 }
  
  public when_click_DeleteTask1 (  ) {
  this.sut.deleteTaskClicked (  );
 }
  
  public when_LoadView7 (  ) {
  this.sut.loadView (  );
 }
  
  public when_select_row_2_in_Tasks (  ) {
  this.sut.tasksRowSelected ( "2" );
 }
  
  public when_click_DeleteTask2 (  ) {
  this.sut.deleteTaskClicked (  );
 }
  
  public when_LoadView8 (  ) {
  this.sut.loadView (  );
 }
  
  public when_click_DeleteTask3 (  ) {
  this.sut.deleteTaskClicked (  );
 }
  
  public when_click_DeleteTask4 (  ) {
  this.sut.deleteTaskClicked (  );
 }
  
  public when_click_DeleteTask5 (  ) {
  this.sut.deleteTaskClicked (  );
 }
  
  public when_LoadView9 (  ) {
  this.sut.loadView (  );
 }
  
  public when_LoadView10 (  ) {
  this.sut.loadView (  );
 }
  
  public when_LoadView11 (  ) {
  this.sut.loadView (  );
 }
  
  public when_LoadView12 (  ) {
  this.sut.loadView (  );
 }
  
  public when_select_row_0_in_Tasks1 (  ) {
  this.sut.tasksRowSelected ( "0" );
 }
  
  public when_click_DeleteTask6 (  ) {
  this.sut.deleteTaskClicked (  );
 }
  
  // Then Helper Definitions

  
  public then_Tasks_has_3_rows_and_selected_row_handle_2 (  ) {
  let actualRows: TaskListViewModelTasksRow [] = this.sut.getTasksWidgetTableRows (  );
   AssertEqual ( 3, actualRows->size (  ) );
   {
  let row0: TaskListViewModelTasksRow = actualRows[ 1 ];
   AssertEqual ( "0", row0.getRowHandle (  ) );
   AssertEqual ( "PrioLow", row0.getPriorityImageSource (  ) );
   AssertEqual ( "Exercise", row0.getTask_NameText (  ) );
   AssertEqual ( "2024/01/04", row0.getDue_DateText (  ) );
   AssertEqual ( "4th January 2024", row0.getDue_DateToolTip (  ) );
 }
   {
  let row1: TaskListViewModelTasksRow = actualRows[ 2 ];
   AssertEqual ( "1", row1.getRowHandle (  ) );
   AssertEqual ( "PrioHigh", row1.getPriorityImageSource (  ) );
   AssertEqual ( "Taxes", row1.getTask_NameText (  ) );
   AssertEqual ( "red", row1.getTask_NameTextColor (  ) );
   AssertEqual ( "2023/12/31", row1.getDue_DateText (  ) );
   AssertEqual ( "red", row1.getDue_DateTextColor (  ) );
   AssertEqual ( "31st December 2023", row1.getDue_DateToolTip (  ) );
 }
   {
  let row2: TaskListViewModelTasksRow = actualRows[ 3 ];
   AssertEqual ( "2", row2.getRowHandle (  ) );
   AssertEqual ( "PrioMedium", row2.getPriorityImageSource (  ) );
   AssertEqual ( "<New Task>", row2.getTask_NameText (  ) );
   AssertEqual ( "", row2.getDue_DateText (  ) );
 }
   AssertEqual ( "2", this.sut.getTasksSelectedRow (  ) );
 }
  
  public then_AddNewTask_is_enabled (  ) {
  AssertTrue ( this.sut.getIsAddNewTaskEnabled (  ) );
 }
  
  public then_DeleteTask_is_enabled (  ) {
  AssertTrue ( this.sut.getIsDeleteTaskEnabled (  ) );
 }
  
  public then_Tasks_has_0_rows (  ) {
  let actualRows: TaskListViewModelTasksRow [] = this.sut.getTasksWidgetTableRows (  );
   AssertEqual ( 0, actualRows->size (  ) );
 }
  
  public then_Tasks_has_1_rows (  ) {
  let actualRows: TaskListViewModelTasksRow [] = this.sut.getTasksWidgetTableRows (  );
   AssertEqual ( 1, actualRows->size (  ) );
   {
  let row0: TaskListViewModelTasksRow = actualRows[ 1 ];
   AssertEqual ( "0", row0.getRowHandle (  ) );
   AssertEqual ( "PrioLow", row0.getPriorityImageSource (  ) );
   AssertEqual ( "A", row0.getTask_NameText (  ) );
   AssertEqual ( "2024/12/01", row0.getDue_DateText (  ) );
 }
 }
  
  public then_Tasks_has_2_rows_and_selected_row_handle_0 (  ) {
  let actualRows: TaskListViewModelTasksRow [] = this.sut.getTasksWidgetTableRows (  );
   AssertEqual ( 2, actualRows->size (  ) );
   {
  let row0: TaskListViewModelTasksRow = actualRows[ 1 ];
   AssertEqual ( "0", row0.getRowHandle (  ) );
   AssertEqual ( "A", row0.getTask_NameText (  ) );
 }
   {
  let row1: TaskListViewModelTasksRow = actualRows[ 2 ];
   AssertEqual ( "1", row1.getRowHandle (  ) );
   AssertEqual ( "B", row1.getTask_NameText (  ) );
 }
   AssertEqual ( "0", this.sut.getTasksSelectedRow (  ) );
 }
  
  public then_Tasks_has_2_rows_and_selected_row_handle_1 (  ) {
  let actualRows: TaskListViewModelTasksRow [] = this.sut.getTasksWidgetTableRows (  );
   AssertEqual ( 2, actualRows->size (  ) );
   {
  let row0: TaskListViewModelTasksRow = actualRows[ 1 ];
   AssertEqual ( "0", row0.getRowHandle (  ) );
   AssertEqual ( "A", row0.getTask_NameText (  ) );
 }
   {
  let row1: TaskListViewModelTasksRow = actualRows[ 2 ];
   AssertEqual ( "1", row1.getRowHandle (  ) );
   AssertEqual ( "PrioMedium", row1.getPriorityImageSource (  ) );
   AssertEqual ( "<New Task>", row1.getTask_NameText (  ) );
   AssertEqual ( "", row1.getDue_DateText (  ) );
 }
   AssertEqual ( "1", this.sut.getTasksSelectedRow (  ) );
 }
  
  public then_Tasks_has_2_rows_and_selected_row_handle_11 (  ) {
  let actualRows: TaskListViewModelTasksRow [] = this.sut.getTasksWidgetTableRows (  );
   AssertEqual ( 2, actualRows->size (  ) );
   {
  let row0: TaskListViewModelTasksRow = actualRows[ 1 ];
   AssertEqual ( "1", row0.getRowHandle (  ) );
   AssertEqual ( "B", row0.getTask_NameText (  ) );
 }
   {
  let row1: TaskListViewModelTasksRow = actualRows[ 2 ];
   AssertEqual ( "2", row1.getRowHandle (  ) );
   AssertEqual ( "C", row1.getTask_NameText (  ) );
 }
   AssertEqual ( "1", this.sut.getTasksSelectedRow (  ) );
 }
  
  public then_Tasks_has_2_rows_and_selected_row_handle_2 (  ) {
  let actualRows: TaskListViewModelTasksRow [] = this.sut.getTasksWidgetTableRows (  );
   AssertEqual ( 2, actualRows->size (  ) );
   {
  let row0: TaskListViewModelTasksRow = actualRows[ 1 ];
   AssertEqual ( "0", row0.getRowHandle (  ) );
   AssertEqual ( "A", row0.getTask_NameText (  ) );
 }
   {
  let row1: TaskListViewModelTasksRow = actualRows[ 2 ];
   AssertEqual ( "2", row1.getRowHandle (  ) );
   AssertEqual ( "C", row1.getTask_NameText (  ) );
 }
   AssertEqual ( "2", this.sut.getTasksSelectedRow (  ) );
 }
  
  public then_Tasks_has_2_rows_and_selected_row_handle_12 (  ) {
  let actualRows: TaskListViewModelTasksRow [] = this.sut.getTasksWidgetTableRows (  );
   AssertEqual ( 2, actualRows->size (  ) );
   {
  let row0: TaskListViewModelTasksRow = actualRows[ 1 ];
   AssertEqual ( "0", row0.getRowHandle (  ) );
   AssertEqual ( "A", row0.getTask_NameText (  ) );
 }
   {
  let row1: TaskListViewModelTasksRow = actualRows[ 2 ];
   AssertEqual ( "1", row1.getRowHandle (  ) );
   AssertEqual ( "B", row1.getTask_NameText (  ) );
 }
   AssertEqual ( "1", this.sut.getTasksSelectedRow (  ) );
 }
  
  public then_Tasks_has_0_rows1 (  ) {
  let actualRows: TaskListViewModelTasksRow [] = this.sut.getTasksWidgetTableRows (  );
   AssertEqual ( 0, actualRows->size (  ) );
 }
  
  public then_Tasks_has_3_rows (  ) {
  let actualRows: TaskListViewModelTasksRow [] = this.sut.getTasksWidgetTableRows (  );
   AssertEqual ( 3, actualRows->size (  ) );
   {
  let row0: TaskListViewModelTasksRow = actualRows[ 1 ];
   AssertEqual ( "0", row0.getRowHandle (  ) );
   AssertEqual ( "PrioLow", row0.getPriorityImageSource (  ) );
 }
   {
  let row1: TaskListViewModelTasksRow = actualRows[ 2 ];
   AssertEqual ( "1", row1.getRowHandle (  ) );
   AssertEqual ( "PrioMedium", row1.getPriorityImageSource (  ) );
 }
   {
  let row2: TaskListViewModelTasksRow = actualRows[ 3 ];
   AssertEqual ( "2", row2.getRowHandle (  ) );
   AssertEqual ( "PrioHigh", row2.getPriorityImageSource (  ) );
 }
 }
  
  public then_Tasks_has_1_rows1 (  ) {
  let actualRows: TaskListViewModelTasksRow [] = this.sut.getTasksWidgetTableRows (  );
   AssertEqual ( 1, actualRows->size (  ) );
   {
  let row0: TaskListViewModelTasksRow = actualRows[ 1 ];
   AssertEqual ( "0", row0.getRowHandle (  ) );
   AssertEqual ( "Task A", row0.getTask_NameText (  ) );
   AssertEqual ( "red", row0.getTask_NameTextColor (  ) );
   AssertEqual ( "2023/01/01", row0.getDue_DateText (  ) );
   AssertEqual ( "red", row0.getDue_DateTextColor (  ) );
 }
 }
  
  public then_Tasks_has_1_rows2 (  ) {
  let actualRows: TaskListViewModelTasksRow [] = this.sut.getTasksWidgetTableRows (  );
   AssertEqual ( 1, actualRows->size (  ) );
   {
  let row0: TaskListViewModelTasksRow = actualRows[ 1 ];
   AssertEqual ( "0", row0.getRowHandle (  ) );
   AssertEqual ( "2024/10/11", row0.getDue_DateText (  ) );
   AssertEqual ( "11th October 2024", row0.getDue_DateToolTip (  ) );
 }
 }
  
  public then_AddNewTask_is_enabled1 (  ) {
  AssertTrue ( this.sut.getIsAddNewTaskEnabled (  ) );
 }
  
  public then_DeleteTask_is_not_enabled (  ) {
  AssertFalse ( this.sut.getIsDeleteTaskEnabled (  ) );
 }
}